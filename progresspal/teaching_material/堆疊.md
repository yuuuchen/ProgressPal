# 3 堆疊資料結構

## 3-1 什麼是堆疊 (Stack)

### 3-1-1 定義

- 堆疊是一種線性資料結構，遵循後進先出（Last In First Out，LIFO）原則。最後加入的元素會最先被移除，就像一疊煎餅只能從最上面拿取。
- 堆疊廣泛應用於函式呼叫、表達式計算及瀏覽器歷史紀錄等。

### 3-1-2 基本概念

- **Push**：將新元素加入堆疊頂端。
- **Pop**：移除並回傳堆疊頂端元素。
- **Peek**：回傳堆疊頂端元素但不移除它。
- **isEmpty**：檢查堆疊是否為空。
- **Size**：回傳堆疊中元素個數。

***

## 3-2 堆疊的實作方法

### 3-2-1 使用Python列表實作堆疊

Python的列表（list）原生提供append()和pop()方法，可以用來實作堆疊。此方法簡單且效率一般。

範例：

```python
stack = []
stack.append('A')  # Push
stack.append('B')
stack.append('C')
top_element = stack[-1]  # Peek
popped_element = stack.pop()  # Pop
```

優點：

- 易於理解與使用。
- 不需額外模組支援。

缺點：

- 當列表擴充時，push操作效能可能較差。


### 3-2-2 使用類別封裝堆疊（Stack Class）

封裝堆疊功能更具結構化，方便維護擴展。

範例：

```python
class Stack:
    def __init__(self):
        self.stack = []
    def push(self, element):
        self.stack.append(element)
    def pop(self):
        if self.isEmpty():
            return "Stack is empty"
        return self.stack.pop()
    def peek(self):
        if self.isEmpty():
            return "Stack is empty"
        return self.stack[-1]
    def isEmpty(self):
        return len(self.stack) == 0
    def size(self):
        return len(self.stack)
```


### 3-2-3 使用鏈結串列實作堆疊

堆疊的節點用鏈結串列節點表示，節點包含資料與指向下一節點的指標。

優點：

- 堆疊大小可動態變化，不受限陣列大小。
- 插入、刪除操作效率穩定（O(1)）。

缺點：

- 需額外空間存儲指標。
- 程式碼較複雜。

範例：

```python
class Node:
    def __init__(self, value):
        self.value = value
        self.next = None

class Stack:
    def __init__(self):
        self.head = None
        self.size = 0
    def push(self, value):
        new_node = Node(value)
        new_node.next = self.head
        self.head = new_node
        self.size += 1
    def pop(self):
        if self.isEmpty():
            return "Stack is empty"
        popped_node = self.head
        self.head = self.head.next
        self.size -= 1
        return popped_node.value
    def peek(self):
        if self.isEmpty():
            return "Stack is empty"
        return self.head.value
    def isEmpty(self):
        return self.size == 0
    def stackSize(self):
        return self.size
```


***

## 3-3 堆疊的應用

- **Undo/Redo 功能**：文字編輯器使用兩個堆疊實作，分別追蹤撤銷與重做操作。
- **瀏覽器歷史紀錄**：用堆疊記錄瀏覽頁面，實作前進和後退。
- **函式呼叫堆疊 (Call Stack)**：程式執行過程中用於保存函式呼叫狀態，確保函式正確返回。
- **表達式計算與語法分析**：編譯器和計算器中，堆疊用來處理中序、後序表達式轉換與運算。

***

## 3-4 堆疊使用Python實作總結

| 實作類型 | 優點 | 缺點 |
| :-- | :-- | :-- |
| Python列表 | 簡單易用，無需額外模組支持 | 重度擴充時推入(push)操作較慢 |
| collections.deque | 推入和彈出效率穩定（O(1)），適大資料集 | 需要額外導入模組 |
| 鏈結串列 | 動態大小，插入與刪除操作高效（O(1)） | 實作較複雜，額外空間(指標)需求 |


***
